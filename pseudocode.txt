# A script to transform raw CT values from a PCR excel file to deltaCT and deltadeltaCT
# CT values are from different genes, from cell treated at different days
# Create a new file to put new values and t-test comparing different days for one gene
# Using qpcr package installed via pip

# First need to install and import all packages
pip install qpcr
import pandas as pd
import numpy as np
from scipy.stats import ttest_ind


# the files from the PCR machine are excel format, need to transform them to csv file first
read_file = pd.read_excel ("name_file")
read_file.to_csv ("path\name.csv", index = None, header=True)


# indicate which datas are to be analysed
analyser = qpcr.Analyser(put pathway to each target from path\name.csv)
# indicate which datas are the control
normaliser = qpcr.Normaliser(put pathway to control from path\name.csv)

# need datareader to read the file
reader = qpcr.DataReader()
# read your files
assays, normalisers = reader.read( [assays, normalisers] )

# first need to calculate deltaCT which is normalisation of datas to the control
assays = qpcr.delta_ct(assays)
normalisers = qpcr.delta_ct(normalisers)

# then calculte deltadeltaCT which is normalisation of deltaCT
results = qpcr.normalise(assays, normalisers)

#qpcr package can do graphs
fig = results.preview()


# now should have ddCT values for each gene and conditions, comparing 0h to the other hours
# need to calculate t-test for each gene comparing 0day and 2 days and also 0day 4days using scipy.stats

ttest = ttest_ind(v1, v2)
	if pvalue < 0.05
		write *
	elif pvalue < 0.01
		write **
	elif pvalue < 0.001
		write ***
	else write not statistically significant
